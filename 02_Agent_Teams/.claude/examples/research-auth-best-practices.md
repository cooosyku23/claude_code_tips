# Node.js 認証ベストプラクティス — エージェントチームによるリサーチレポート

## 目的
Node.js で REST API サーバ（Express or Fastify 想定）に認証機能を実装する際のベストプラクティスを調査するため、3 人のチームメートからなるエージェントチームを作る。
各チームメートが専門視点から調査・議論し、最終レポートとして統合する。
対象読者: バックエンド開発チーム（中級以上）およびテックリード。

---

## エージェントチーム構成（3 人のチームメート）

### チームメート S（Security Standards）
- 専門: OAuth 2.0 / OIDC, JWT, セッション認証, Passkey/WebAuthn, MFA
- 責務: 各方式のセキュリティ特性、脅威モデル（トークン漏洩・CSRF・リプレイ等）、OWASP 推奨事項を整理

### チームメート P（Performance & Scalability）
- 専門: トークン検証コスト、セッションストア選定、レイテンシ、水平スケール時の影響
- 責務: 認証方式ごとのパフォーマンス特性、ボトルネック、ベンチマーク観点を整理

### チームメート C（Case Studies）
- 専門: 実プロジェクト事例、主要 OSS/SaaS（Auth0, Clerk, Supabase Auth, NextAuth/Auth.js, Passport.js 等）の採用パターン
- 責務: 実際の成功・失敗事例、ライブラリ/サービスの比較、移行の教訓を整理

---

## 実行フェーズ

### Phase 1: 個別調査（各チームメートが独立にレポートを出す）
各チームメートは以下の構造で出力すること：
- **調査対象**: 扱った認証方式・技術・事例の一覧
- **知見**: 箇条書き（各項目 2〜4 文）
- **評価サマリ（表）**: 下記の共通評価軸で各方式を 5 段階評価

#### 共通評価軸（全チームメート共通）
| 軸 | 説明 |
|---|---|
| セキュリティ強度 | 既知の攻撃への耐性 |
| 実装コスト | 初期導入の開発工数 |
| 運用負荷 | 鍵管理・ローテーション・監視の手間 |
| スケーラビリティ | 水平スケール・マルチリージョン対応 |
| DX（開発者体験） | ライブラリ成熟度・ドキュメント・デバッグ容易性 |

### Phase 2: クロスレビュー（チームメート間の議論）
- 各チームメートは他 2 名の Phase 1 出力を読み、矛盾・補足・反論を 3〜5 点ずつ指摘する。
- 議論は「論点 → 根拠 → 結論/未解決」の形式で簡潔にまとめる。
- ※ 芝居がかった会話は不要。論点ベースで構造化すること。

### Phase 3: 統合レポート（最終成果物）
エージェントチーム全体の調査・議論（Phase 1・2）を踏まえ、以下の構成で Markdown レポートを出力する：

```
## 統合レポート構成

### 1. エグゼクティブサマリ（10 行以内）
### 2. 認証方式の比較表（共通評価軸 × 方式）
### 3. 方式別の詳細分析
   - セキュリティ観点（チームメート S）
   - パフォーマンス観点（チームメート P）
   - 実事例・ライブラリ観点（チームメート C）
### 4. 推奨パターン（ユースケース別）
   - シンプルな SaaS API
   - マルチテナント B2B
   - マイクロサービス間認証
### 5. アンチパターンと落とし穴
### 6. 推奨アクション（優先順位付き、次のステップ）
```

---

## 制約・注意
- 出力言語: 日本語（技術用語は英語表記可）
- 各 Phase の出力を省略せず、Phase 1 → 2 → 3 の順に出力すること
- 推測や一般論で埋めず、根拠（RFC, OWASP, 公式ドキュメント, 既知のインシデント等）を示すこと
- 特定製品の宣伝にならないよう、比較は客観的に行うこと
- 2024〜2025 年時点の情報を基準とすること